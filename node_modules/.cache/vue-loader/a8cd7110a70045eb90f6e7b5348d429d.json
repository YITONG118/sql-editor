{"remainingRequest":"/Users/lishumin/Desktop/demo/sql-editor/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lishumin/Desktop/demo/sql-editor/src/sqlEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lishumin/Desktop/demo/sql-editor/src/sqlEditor.vue","mtime":1592982765478},{"path":"/Users/lishumin/Desktop/demo/sql-editor/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lishumin/Desktop/demo/sql-editor/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lishumin/Desktop/demo/sql-editor/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lishumin/Desktop/demo/sql-editor/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGNvZGVtaXJyb3IsIENvZGVNaXJyb3IgfSBmcm9tICJ2dWUtY29kZW1pcnJvciI7CmltcG9ydCBzcWxGb3JtYXR0ZXIgZnJvbSAic3FsLWZvcm1hdHRlciI7Cl8gPSByZXF1aXJlKCdsb2Rhc2gnKQppbXBvcnQgImNvZGVtaXJyb3IvbGliL2NvZGVtaXJyb3IuY3NzIjsKLy8g6K+t6KiA6K+t5rOVCmltcG9ydCAiY29kZW1pcnJvci9tb2RlL3NxbC9zcWwiOwovLyBzcWzor63oqIDmj5DnpLoKaW1wb3J0ICJjb2RlbWlycm9yL2FkZG9uL2hpbnQvc3FsLWhpbnQuanMiOwoKLy8gYWN0aXZlLWxpbmUuanMKaW1wb3J0ICJjb2RlbWlycm9yL2FkZG9uL3NlbGVjdGlvbi9hY3RpdmUtbGluZS5qcyI7CgovLyBzdHlsZVNlbGVjdGVkVGV4dAppbXBvcnQgImNvZGVtaXJyb3IvYWRkb24vc2VsZWN0aW9uL21hcmstc2VsZWN0aW9uLmpzIjsKaW1wb3J0ICJjb2RlbWlycm9yL2FkZG9uL3NlYXJjaC9zZWFyY2hjdXJzb3IuanMiOwoKLy8g6Ieq5Yqo5o+Q56S6CmltcG9ydCAiY29kZW1pcnJvci9hZGRvbi9oaW50L3Nob3ctaGludC5qcyI7CmltcG9ydCAiY29kZW1pcnJvci9hZGRvbi9oaW50L3Nob3ctaGludC5jc3MiOwoKLy8gaGlnaGxpZ2h0U2VsZWN0aW9uTWF0Y2hlcwppbXBvcnQgImNvZGVtaXJyb3IvYWRkb24vc2Nyb2xsL2Fubm90YXRlc2Nyb2xsYmFyLmpzIjsKaW1wb3J0ICJjb2RlbWlycm9yL2FkZG9uL3NlYXJjaC9tYXRjaGVzb25zY3JvbGxiYXIuanMiOwppbXBvcnQgImNvZGVtaXJyb3IvYWRkb24vc2VhcmNoL3NlYXJjaGN1cnNvci5qcyI7CmltcG9ydCAiY29kZW1pcnJvci9hZGRvbi9zZWFyY2gvbWF0Y2gtaGlnaGxpZ2h0ZXIuanMiOwovLyBrZXlNYXAKaW1wb3J0ICJjb2RlbWlycm9yL21vZGUvY2xpa2UvY2xpa2UuanMiOwppbXBvcnQgImNvZGVtaXJyb3Iva2V5bWFwL3N1YmxpbWUuanMiOwoKLy8gZm9sZEd1dHRlcgppbXBvcnQgImNvZGVtaXJyb3IvYWRkb24vZm9sZC9mb2xkZ3V0dGVyLmNzcyI7CmltcG9ydCAiY29kZW1pcnJvci9hZGRvbi9mb2xkL2JyYWNlLWZvbGQuanMiOwppbXBvcnQgImNvZGVtaXJyb3IvYWRkb24vZm9sZC9jb21tZW50LWZvbGQuanMiOwppbXBvcnQgImNvZGVtaXJyb3IvYWRkb24vZm9sZC9mb2xkY29kZS5qcyI7CmltcG9ydCAiY29kZW1pcnJvci9hZGRvbi9mb2xkL2ZvbGRndXR0ZXIuanMiOwppbXBvcnQgImNvZGVtaXJyb3IvYWRkb24vZm9sZC9pbmRlbnQtZm9sZC5qcyI7CmltcG9ydCAiY29kZW1pcnJvci9hZGRvbi9mb2xkL21hcmtkb3duLWZvbGQuanMiOwppbXBvcnQgImNvZGVtaXJyb3IvYWRkb24vZm9sZC94bWwtZm9sZC5qcyI7CgovLyB0aGVtZSBjc3MKaW1wb3J0ICJjb2RlbWlycm9yL3RoZW1lL3hxLWRhcmsuY3NzIjsKaW1wb3J0ICJjb2RlbWlycm9yL3RoZW1lL3hxLWxpZ2h0LmNzcyI7CgppbXBvcnQgeyBLRVlXT1JEUywgRlVOQ1RJT05TIH0gZnJvbSAiLi9lZGl0b3ItYm94IjsKCgovLyDljLnphY0g77yIZnJvbSB8fCBqb2lu77yJ5YWz6ZSu5a2XCmNvbnN0IFRBQkxFX1NVR0dFU0VUX1BPU19SRUcgPSAvKF58XHMrKShmcm9tfGpvaW4pXHMrKFxTKikkL2k7CgovLyDljLnphY3ooajlkI0g5Yir5ZCNCmNvbnN0IFRBQkxFU19QQVRURU5TID0gWwogIC9cc2pvaW5ccysoW1x3Ll9gXSspXHMqKD86YXMpP1xzKihbXHdfYF0rKT8vZ2ksCiAgL1xzZnJvbVxzKyhbXHcuX2BdKylccyooPzphcyk/XHMqKFtcd19gXSspPy9naQpdOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJzcWxFZGl0b3IiLAogIGNvbXBvbmVudHM6IHsKICAgIGNvZGVtaXJyb3IKICB9LAogIHByb3BzOiB7fSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc3FsQ29kZTogJ3NlbGVjdFxuJyArCiAgICAgICAgICAgICAgJyAgZGlzdGluY3QgdXNlcmlkXG4nICsKICAgICAgICAgICAgICAnZnJvbVxuJyArCiAgICAgICAgICAgICAgJyAgdHV0b3Iuc190dXRvcl9vcmRlcl90cFxuJyArCiAgICAgICAgICAgICAgJ3doZXJlXG4nICsKICAgICAgICAgICAgICAnICBkYXRlZGlmZihcJzIwMTYtMDgtMDhcJywgcGFpZGR0KSA+PSAxXG4nICsKICAgICAgICAgICAgICAnICBhbmQgZGF0ZWRpZmYoXCcyMDE2LTA4LTA4XCcsIHBhaWRkdCkgPD0g77yfIO+8nyAtLei/h+WOu++8n+WkqScsCiAgICAgIGVkaXRvck9wdGlvbnM6IHsKICAgICAgICAvLyBjb2RlbWlycm9yIG9wdGlvbnMKICAgICAgICB0YWJTaXplOiA0LAogICAgICAgIG1vZGU6ICJ0ZXh0L3gtbXlzcWwiLAogICAgICAgIHRoZW1lOiAieHEtbGlnaHQiLAogICAgICAgIGZ1bGxTY3JlZW46IGZhbHNlLAogICAgICAgIGxpbmVOdW1iZXJzOiB0cnVlLAogICAgICAgIGxpbmU6IHRydWUsCiAgICAgICAgLy8g5Luj56CB5oqY5Y+gCiAgICAgICAgZm9sZEd1dHRlcjogdHJ1ZSwKICAgICAgICBndXR0ZXJzOiBbIkNvZGVNaXJyb3ItbGluZW51bWJlcnMiLCAiQ29kZU1pcnJvci1mb2xkZ3V0dGVyIl0sCiAgICAgICAgLy8g6auY57qn6YWN572u77yI6ZyA6KaB5byV5YWl5a+55bqU55qE5o+S5Lu25YyF77yJLGNvZGVtaXJyb3IgYWR2YW5jZWQgb3B0aW9ucyhZb3UgbmVlZCB0byBtYW51YWxseSBpbnRyb2R1Y2UgdGhlIGNvcnJlc3BvbmRpbmcgY29kZW1pcnJvciBmdW5jdGlvbiBzY3JpcHQgY29kZSkKICAgICAgICAvLyBzdWJsaW1l44CBZW1hY3PjgIF2aW3kuInnp43plK7kvY3mqKHlvI/vvIzmlK/mjIHkvaDnmoTkuI3lkIzmk43kvZzkuaDmg68KICAgICAgICBrZXlNYXA6ICJzdWJsaW1lIiwKICAgICAgICAvLyDmjInplK7mmKDlsITvvIzmr5TlpoJDdHJs6ZSu5pig5bCEYXV0b2NvbXBsZXRl77yMYXV0b2NvbXBsZXRl5pivaGludOS7o+eggeaPkOekuuS6i+S7tgogICAgICAgIGV4dHJhS2V5czogewogICAgICAgICAgRjk6ICgpID0+IHsKICAgICAgICAgICAgdGhpcy5mb3JtYXRTcWxGdW4oKTsKICAgICAgICAgIH0sCiAgICAgICAgICAiQ3RybC1zcGFjZSI6ICJhdXRvY29tcGxldGUiCiAgICAgICAgfSwKICAgICAgICBzaG93SGl0T2JqOiBudWxsLCAvLyDlu7bov5/mmL7npLrogZTmg7PliJfooagKICAgICAgICBjdXJyZW50V29yZDogIiIsIC8vIOWFs+mUruWtl+iusOW9lQogICAgICAgIHVwZGF0ZVRpbWVyOiBudWxsLAogICAgICAgIHNxbFN1Z2dlc3RMaXN0OiBbXSwKICAgICAgICAvLyDogZTmg7Plip/og70KICAgICAgICAvLyBoaW50OiDvvIhjbSkgPT4gewogICAgICAgIC8vICAgcmV0dXJuIHRoaXMuSGludCgpOwogICAgICAgIC8vIH0KICAgICAgICAvLyBoaW50LmpzIG9wdGlvbnMKICAgICAgICBoaW50T3B0aW9uczogewogICAgICAgICAgLy8g5b2T5Yy56YWN5Y+q5pyJ5LiA6aG555qE5pe25YCZ5piv5ZCm6Ieq5Yqo6KGl5YWoCiAgICAgICAgICBjb21wbGV0ZVNpbmdsZTogZmFsc2UKICAgICAgICB9LAogICAgICAgIC8vIOiBlOaDs+ihqOWQjQogICAgICAgIHNxbFN1Z2dlc3RUYWJsZU5hbWVMaXN0czogW10sCiAgICAgICAgLy8g6IGU5oOz6KGoCiAgICAgICAgc3FsU3VnZ2VzdFRhYmxlTGlzdHM6IFtdLAogICAgICAgIC8vIOiBlOaDs+WIl+WQjQogICAgICAgIHNxbFN1Z2dlc3RDb2x1bW5zOiBbXSwKICAgICAgICBydW5DdXI6IG51bGwKICAgICAgICAvLyDpgInkuK3mlofmnKzoh6rliqjpq5jkuq7vvIzlj4rpq5jkuq7mlrnlvI8KICAgICAgICAvLyBzdHlsZVNlbGVjdGVkVGV4dDogdHJ1ZSwKICAgICAgICAvLyBoaWdobGlnaHRTZWxlY3Rpb25NYXRjaGVzOiB7IHNob3dUb2tlbjogL1x3LywgYW5ub3RhdGVTY3JvbGxiYXI6IHRydWUgfSwKICAgICAgICAvLyBtb3JlIGNvZGVtaXJyb3Igb3B0aW9ucy4uLgogICAgICAgIC8vIOWmguaenOaciWhpbnTmlrnpnaLnmoTphY3nva7vvIzkuZ/lupTor6Xlh7rnjrDlnKjov5nph4wKICAgICAgfQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBjb2RlbWlycm9yKCkgewogICAgICByZXR1cm4gdGhpcy4kcmVmcy5jb2RlRWRpdG9yLmNvZGVtaXJyb3I7CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgaWYgKHRoaXMuJHJlZnMuY29kZUVkaXRvcikgewogICAgICAvLyDnu5HlrprplK7nm5jkuovku7YKICAgICAgdGhpcy4kcmVmcy5jb2RlRWRpdG9yLmNvZGVtaXJyb3Iub24oImtleXVwIiwgdGhpcy5oYW5kbGVFZGl0b3JLZXlVcCk7CiAgICB9CiAgfSwKICBkZXN0cm95ZWQoKSB7fSwKICBtZXRob2RzOiB7CiAgICAvLyDogZTmg7PooajlkI0KICAgIGF1dG9jb21wbGV0ZVRhYmxlcyhlZGl0b3IpIHsKICAgICAgbGV0IGN1ciA9IGVkaXRvci5nZXRDdXJzb3IoKTsKICAgICAgbGV0IHRva2VuID0gdGhpcy5nZXRUb2tlbihlZGl0b3IsIGN1cik7CiAgICAgIGxldCB3b3JkID0gdG9rZW4uc3RyaW5nLnRvTG93ZXJDYXNlKCk7CiAgICAgIGxldCBsaXN0ID0gW107CgogICAgICBsaXN0ID0gdGhpcy5nZXRTdWdnZXN0TGlzdEJ5UmVxdXNlc3QodGhpcy5zcWxTdWdnZXN0VGFibGVOYW1lTGlzdHMsIHdvcmQpOwogICAgICB0aGlzLmhpbnRTb3J0KGxpc3QsIHdvcmQpOwogICAgICByZXR1cm4gewogICAgICAgIGxpc3Q6IGxpc3QsCiAgICAgICAgZnJvbTogQ29kZU1pcnJvci5Qb3MoY3VyLmxpbmUsIHRva2VuLnN0YXJ0KSwKICAgICAgICB0bzogQ29kZU1pcnJvci5Qb3MoY3VyLmxpbmUsIHRva2VuLmVuZCkKICAgICAgfTsKICAgIH0sCiAgICAvLyDogZTmg7PooajlkI185YiX5ZCN5aSE55CGCiAgICBnZXRTdWdnZXN0TGlzdEJ5UmVxdXNlc3QobGlzdCwgd29yZCkgewogICAgICBsZXQgbGlzdEFyciA9IFtdOwogICAgICBsZXQgbWFwID0ge307CiAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBsaXN0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgbGV0IGl0ZW0gPSBsaXN0W2ldLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgaWYgKGl0ZW0uaW5kZXhPZih3b3JkLnRyaW0oKSkgIT09IC0xKSB7CiAgICAgICAgICAvLyBpZiAod29yZCA9PT0gaXRlbSkgewogICAgICAgICAgLy8gICAgIGNvbnRpbnVlOwogICAgICAgICAgLy8gfQogICAgICAgICAgaWYgKCFtYXBbbGlzdFtpXV0pIHsKICAgICAgICAgICAgbGlzdEFyci5wdXNoKGxpc3RbaV0pOwogICAgICAgICAgICBtYXBbbGlzdFtpXV0gPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbGlzdEFycjsKICAgIH0sCiAgICBhdXRvY29tcGxldGVDb2x1bW5zKGVkaXRvcikgewogICAgICBsZXQgbGlzdCA9IFtdOwogICAgICBsZXQgY3VyID0gZWRpdG9yLmdldEN1cnNvcigpOwogICAgICBsZXQgdG9rZW4gPSB0aGlzLmdldFRva2VuKGVkaXRvciwgY3VyKTsKICAgICAgbGV0IHdvcmQgPSB0b2tlbi5zdHJpbmcudG9Mb3dlckNhc2UoKTsKICAgICAgLy/ogZTmg7PliJflkI0KICAgICAgbGV0IHNxbFN1Z2dlc3RDb2x1bW5zID0gdGhpcy5nZXRTdWdnZXN0TGlzdEJ5UmVxdXNlc3QoCiAgICAgICAgdGhpcy5zcWxTdWdnZXN0Q29sdW1ucywKICAgICAgICB3b3JkCiAgICAgICk7CiAgICAgIGxpc3QgPSBsaXN0LmNvbmNhdChzcWxTdWdnZXN0Q29sdW1ucyk7CiAgICAgIHRoaXMuaGludFNvcnQobGlzdCwgd29yZCk7CiAgICAgIGxpc3QgPSBbLi4ubmV3IFNldChsaXN0KV07CgogICAgICByZXR1cm4gewogICAgICAgIGxpc3Q6IGxpc3QsCiAgICAgICAgZnJvbTogQ29kZU1pcnJvci5Qb3MoY3VyLmxpbmUsIHRva2VuLnN0YXJ0KSwKICAgICAgICB0bzogQ29kZU1pcnJvci5Qb3MoY3VyLmxpbmUsIHRva2VuLmVuZCkKICAgICAgfTsKICAgIH0sCiAgICAvLyDmnKzlnLDlhbPplK7lrZfogZTmg7MKICAgIGF1dG9Db21wbGV0ZShlZGl0b3IpIHsKICAgICAgbGV0IENPTUJJTkVEX0tFWVdPUkRTID0gS0VZV09SRFMuY29uY2F0KEZVTkNUSU9OUyk7CiAgICAgIGxldCBjdXIgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7CiAgICAgIGxldCB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oZWRpdG9yLCBjdXIpOwogICAgICBsZXQgd29yZCA9IHRva2VuLnN0cmluZy50b0xvd2VyQ2FzZSgpOwogICAgICBsZXQgbGlzdCA9IFtdOwogICAgICAvLyBsZXQgc3FsID0gZWRpdG9yLmdldFZhbHVlKCk7CgogICAgICAvL+WFs+mUruWtlyzlh73mlbAKICAgICAgaWYgKHdvcmQuaW5kZXhPZigiLiIpIDwgMCkgewogICAgICAgIGxldCBhID0gdGhpcy5nZXRTdWdnZXN0TGlzdEJ5TG9jYWwoQ09NQklORURfS0VZV09SRFMsIHdvcmQpOwogICAgICAgIGxpc3QgPSBsaXN0LmNvbmNhdChhKTsKICAgICAgfQogICAgICAvL+WPmOmHjwogICAgICBpZiAod29yZC5pbmRleE9mKCIuIikgPCAwKSB7CiAgICAgICAgaWYgKHRoaXMuc3lzdGVtVmFycyAmJiB0aGlzLnN5c3RlbVZhcnMubGVuZ3RoKSB7CiAgICAgICAgICBsZXQgYXJyID0gdGhpcy5nZXRTdWdnZXN0TGlzdEJ5TG9jYWwodGhpcy5zeXN0ZW1WYXJzLCB3b3JkKTsKICAgICAgICAgIGxpc3QgPSBsaXN0LmNvbmNhdChhcnIpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmhpbnRTb3J0KGxpc3QsIHdvcmQpOwogICAgICAvLyBpZiAobGlzdC5sZW5ndGggPCAxMCkgeyAvLyDliqDlhaXlt7Lnu4/ovpPlhaXnmoTljZXor43ogZTmg7PlhbPplK7lrZcKICAgICAgLy8gICAgIGxldCB3b3JkcyA9IHNxbC5zcGxpdCgvW15cd19cdTRlMDAtXHU5ZmE1XS8pOwogICAgICAvLyAgICAgbGV0IG53b3JkcyA9IFtdOwogICAgICAvLyAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykgewogICAgICAvLyAgICAgICAgIGlmICgoIXdvcmRzW2ldKSB8fCAod29yZCA9PT0gd29yZHNbaV0pKSB7CiAgICAgIC8vICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAvLyAgICAgICAgIH0KICAgICAgLy8gICAgICAgICBud29yZHMucHVzaCh3b3Jkc1tpXSk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBsaXN0ID0gbGlzdC5jb25jYXQodGhpcy5nZXRTdWdnZXN0TGlzdEJ5TG9jYWwobndvcmRzLCB3b3JkKSk7CiAgICAgIC8vIH0KICAgICAgbGlzdCA9IFsuLi5uZXcgU2V0KGxpc3QpXTsKCiAgICAgIHJldHVybiB7CiAgICAgICAgbGlzdDogbGlzdCwKICAgICAgICBmcm9tOiBDb2RlTWlycm9yLlBvcyhjdXIubGluZSwgdG9rZW4uc3RhcnQpLAogICAgICAgIHRvOiBDb2RlTWlycm9yLlBvcyhjdXIubGluZSwgdG9rZW4uZW5kKQogICAgICB9OwogICAgfSwKICAgIC8vIOmAmui/h+WFs+mUruWtlyDljLnphY3ojrflj5ZzdWdnZXN05YiX6KGoCiAgICBnZXRTdWdnZXN0TGlzdEJ5TG9jYWwobGlzdCwgd29yZCkgewogICAgICBpZiAod29yZC50cmltKCkgPT09ICIiKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CgogICAgICBsZXQgbWFwID0ge307CiAgICAgIGxldCBsaXN0QXJyID0gW107CiAgICAgIGZvciAobGV0IGkgPSAwLCBsb2NhbEwgPSBsaXN0Lmxlbmd0aDsgaSA8IGxvY2FsTDsgaSsrKSB7CiAgICAgICAgbGV0IGEgPSBsaXN0W2ldLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgaWYgKGEuaW5kZXhPZih3b3JkLnRyaW0oKSkgIT09IC0xKSB7CiAgICAgICAgICAvLyBpZiAoaXNTZWxmICYmICh3b3JkID09PSBhKSkgewogICAgICAgICAgLy8gICAgIGNvbnRpbnVlOwogICAgICAgICAgLy8gfQogICAgICAgICAgaWYgKCFtYXBbbGlzdFtpXV0pIHsKICAgICAgICAgICAgbGlzdEFyci5wdXNoKGxpc3RbaV0pOwogICAgICAgICAgICBtYXBbbGlzdFtpXV0gPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGxpc3RBcnI7CiAgICB9LAogICAgaGludFNvcnQoYXJyLCBrZXkpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIuTGVuZ3RoOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gaTsgaiA8IGFyci5MZW5ndGg7IGorKykgewogICAgICAgICAgbGV0IGEgPSBhcnJbaV0udG9Mb3dlckNhc2UoKTsKICAgICAgICAgIGxldCBiID0gYXJyW2pdLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICBpZiAoYS5pbmRleE9mKGtleSkgPiBiLmluZGV4T2Yoa2V5KSkgewogICAgICAgICAgICBsZXQgdGVtcCA9IGFycltpXTsKICAgICAgICAgICAgYXJyW2ldID0gYXJyW2pdOwogICAgICAgICAgICBhcnJbal0gPSB0ZW1wOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGZvcm1hdFNxbEZ1bigpIHsKICAgICAgdGhpcy5zcWxDb2RlID0gc3FsRm9ybWF0dGVyLmZvcm1hdCh0aGlzLnNxbENvZGUsIHt9KTsKICAgIH0sCiAgICAvLyDplK7nm5jkuovku7bnm5HlkKwKICAgIGhhbmRsZUVkaXRvcktleVVwKGVkaXRvciwgZSkgewogICAgICB0aGlzLnRpbWVyICYmIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTsKICAgICAgdGhpcy50aW1lciA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGNvbnN0IHZhbHVlID0gZWRpdG9yLmdldFZhbHVlKCkudHJpbSgpOyAvLyDovpPlhaXnmoTmiYDmnIlzcWwKICAgICAgICBsZXQgY3VyID0gZWRpdG9yLmdldEN1cnNvcigpOwogICAgICAgIGxldCB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oZWRpdG9yLCBjdXIpOwogICAgICAgIGxldCB3b3JkID0gdG9rZW4uc3RyaW5nLnRvTG93ZXJDYXNlKCkudHJpbSgpOyAvLyDlhbPplK7lrZcKCiAgICAgICAgaWYgKAogICAgICAgICAgZS5rZXkgPT09ICJFbnRlciIgfHwKICAgICAgICAgIGUua2V5ID09PSAiVGFiIiB8fAogICAgICAgICAgZS5rZXkgPT09ICJFc2NhcGUiIHx8CiAgICAgICAgICB3b3JkID09PSAiIgogICAgICAgICkgewogICAgICAgICAgdGhpcy5jdXJyZW50V29yZCA9ICIiOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuY3VycmVudFdvcmQgPT09IHdvcmQgJiYKICAgICAgICAgIChlLmtleSA9PT0gIkFycm93VXAiIHx8IGUua2V5ID09PSAiQXJyb3dEb3duIikKICAgICAgICApIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICB0aGlzLmN1cnJlbnRXb3JkID0gd29yZDsKICAgICAgICAvLyDlpI3kvY0KICAgICAgICB0aGlzLnNxbFN1Z2dlc3RDb2x1bW5zID0gW107CiAgICAgICAgdGhpcy5ydW5DdXIgPSBjdXI7CiAgICAgICAgdGhpcy5nZXRTdWdnZXN0RGF0YShlZGl0b3IsIHZhbHVlLCB3b3JkKTsKICAgICAgfSwgMTAwKTsKICAgIH0sCiAgICAvLyDojrflj5blhYnmoIfnmoTkvY3nva4KICAgIGdldFRva2VuKGUsIGN1cikgewogICAgICBsZXQgdCA9IGUuZ2V0VG9rZW5BdChjdXIpOwoKICAgICAgaWYgKAogICAgICAgIHQuc3RyaW5nICYmCiAgICAgICAgKHQuc3RyaW5nLmluZGV4T2YoIi4iKSA+PSAwIHx8IHQuc3RyaW5nLmluZGV4T2YoIiQiKSA+PSAwKQogICAgICApIHsKICAgICAgICBpZiAoY3VyLmNoID4gMCkgewogICAgICAgICAgbGV0IGJlZm9yZSA9IGUuZ2V0VG9rZW5BdCh7CiAgICAgICAgICAgIGxpbmU6IGN1ci5saW5lLAogICAgICAgICAgICBjaDogdC5zdGFydAogICAgICAgICAgfSk7CiAgICAgICAgICB0LnN0cmluZyA9IChiZWZvcmUuc3RyaW5nICsgdC5zdHJpbmcpLnRyaW0oKTsKICAgICAgICAgIHQuc3RhcnQgPSBiZWZvcmUuc3RhcnQ7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB0OwogICAgfSwKICAgIC8vIGV4ZWNTcWwoKSB7CiAgICAvLyAgIGxldCBzcWwgPQogICAgLy8gICAgICh0aGlzLmNvZGVtaXJyb3IgJiYgdGhpcy5jb2RlbWlycm9yLmdldFNlbGVjdGlvbigpKSB8fCB0aGlzLnNxbENvZGU7CiAgICAvLyAgIGxldCBwb3N0RGF0YSA9IHsgZGI6IHRoaXMuZGIsIG5hbWU6IHRoaXMuc3FsTmFtZSwgc3FsIH07CiAgICAvLyAgIGNvbnNvbGUubG9nKGV4ZWNTcWwpOwogICAgLy8gICBleGVjU3FsKHBvc3REYXRhKS50aGVuKGRhdGEgPT4gewogICAgLy8gICAgIGNvbnNvbGUubG9nKGRhdGEpOwogICAgLy8gICB9KTsKICAgIC8vICAgY29uc29sZS5sb2coc3FsKTsKICAgIC8vIH0sCiAgICBnZXRTdWdnZXN0RGF0YShlZGl0b3IsIHZhbHVlLCB3b3JkKSB7CiAgICAgIGxldCBjdXIgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7CiAgICAgIC8vIOiusOW9leW9k+WJjeafpeivouWFs+mUruivjQogICAgICBpZiAod29yZC50cmltKCkgPT09ICIiKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxldCB0YWJsZXNBbGlhcyA9IHRoaXMuZ2V0VGFibGVzQW5kQWxpYXModmFsdWUpOwogICAgICBsZXQgbGVmdFZhbHVlID0gZWRpdG9yLmdldFJhbmdlKHsgbGluZTogMCwgY2g6IDAgfSwgY3VyKTsKICAgICAgLy8gaWYgKFRBQkxFX1NVR0dFU0VUX1BPU19SRUcudGVzdChsZWZ0VmFsdWUpICYmIHRoaXMuZHNOYW1lKSB7CiAgICAgIC8vICAgLy8gZnJvbSBqb2luIOWQjuivt+axguihqOWQjQogICAgICAvLyAgIHRoaXMuZ2V0SGludFRhYmxlcyh7IGRzTmFtZTogdGhpcy5kc05hbWUsIHE6IHdvcmQgfSk7CiAgICAgIC8vIH0gZWxzZSBpZiAodGFibGVzQWxpYXMubGVuZ3RoICYmIHRoaXMuZHNOYW1lKSB7CiAgICAgIC8vICAgLy8g5piv5ZCm5pyJ6KGoIOihqOaYr+WQpuacieWIq+WQjQogICAgICAvLyAgIHRoaXMuZ2V0SGludENvbHVtbnModGFibGVzQWxpYXMsIHdvcmQpOwogICAgICAvLyB9IGVsc2UgewogICAgICAvLyAgIHRoaXMuc2hvd1N1Z2dlc3RNZW51KCJsb2NhbCIpOyAvLyDmnKzlnLDogZTmg7MKICAgICAgLy8gfQogICAgICBpZiAoVEFCTEVfU1VHR0VTRVRfUE9TX1JFRy50ZXN0KGxlZnRWYWx1ZSkpIHsKICAgICAgICAvLyBmcm9tIGpvaW4g5ZCO6K+35rGC6KGo5ZCNCiAgICAgICAgdGhpcy5nZXRIaW50VGFibGVzKCk7CiAgICAgIH0gZWxzZSBpZiAodGFibGVzQWxpYXMubGVuZ3RoKSB7CiAgICAgICAgLy8g5piv5ZCm5pyJ6KGoIOihqOaYr+WQpuacieWIq+WQjQogICAgICAgIHRoaXMuZ2V0SGludENvbHVtbnModGFibGVzQWxpYXMsIHdvcmQpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2hvd1N1Z2dlc3RNZW51KCdsb2NhbCcpOyAvLyDmnKzlnLDogZTmg7MKICAgICAgfQogICAgfSwKICAgIGdldEhpbnRUYWJsZXMoKSB7CiAgICAgIHRoaXMuc3FsU3VnZ2VzdFRhYmxlTmFtZUxpc3RzID0gWydhYWEnLCdiYmInLCdjY2MnLCAnZGVmJywgJ3RhYmxlMScsJ3RhYmxlMicsJ3RhYmxlMycsJ3RhYmxlNCcsICdnaHknXTsKICAgICAgdGhpcy5zaG93U3VnZ2VzdE1lbnUoInRhYmxlIik7CiAgICB9LAogICAgZ2V0SGludENvbHVtbnModGFibGVzQWxpYXMsIHdvcmQpIHsKICAgICAgbGV0IHRhYmxlcyA9IFtdOwogICAgICBsZXQgdGFibGU7CiAgICAgIGxldCBib2R5ID0ge307CiAgICAgIGxldCBsZWZ0V29yZDsKICAgICAgbGV0IGlkeCA9IHdvcmQuaW5kZXhPZigiLiIpOwogICAgICBpZiAoaWR4ICE9PSAtMSkgewogICAgICAgIGxlZnRXb3JkID0gd29yZC5zdWJzdHIoMCwgaWR4KTsKCiAgICAgICAgdGFibGVzQWxpYXMuZm9yRWFjaCgoaXRlbSwgaSkgPT4gewogICAgICAgICAgaWYgKGl0ZW0uYWxpYXMgPT09IGxlZnRXb3JkKSB7CiAgICAgICAgICAgIHRhYmxlID0gaXRlbS5uYW1lOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAodGFibGUpIHsKICAgICAgICAgIGJvZHkudGFibGVzID0gW3RhYmxlXTsKICAgICAgICAgIHRoaXMuZ2V0Q29sdW1uTGlzdCgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0YWJsZXNBbGlhcy5mb3JFYWNoKChpdGVtLCBpKSA9PiB7CiAgICAgICAgICBpZiAoaXRlbS5uYW1lICE9PSAiIikgewogICAgICAgICAgICB0YWJsZXMucHVzaChpdGVtLm5hbWUpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICB0YWJsZXMgPSBbLi4ubmV3IFNldCh0YWJsZXMpXTsKICAgICAgICBib2R5LnRhYmxlcyA9IHRhYmxlczsKCiAgICAgICAgaWYgKHRhYmxlcy5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuZ2V0Q29sdW1uTGlzdCh7IGJvZHkgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZ2V0Q29sdW1uTGlzdCgpIHsKICAgICAgdGhpcy5zcWxTdWdnZXN0Q29sdW1ucyA9IFsndXNlcicsICdhZ2UnLCAnbmFtZScsICdpZCcsICdhYmMnLCAnZWZnJywgJ2hpaicsICdrbG0nLCAnbnV2JywgJ3doJ107CiAgICAgIHRoaXMuc2hvd1N1Z2dlc3RNZW51KCJjb2x1bW4iKTsKICAgIH0sCiAgICAvLyDliKvlkI3mmK/lkKblkIjms5UKICAgIGlzTGVnYWxBbGlhcyhhbGlhcykgewogICAgICBsZXQga2V5d29yZHMgPSB7CiAgICAgICAgd2hlcmU6IDEsCiAgICAgICAgb246IDEsCiAgICAgICAgdXNpbmc6IDEsCiAgICAgICAgam9pbjogMSwKICAgICAgICBncm91cDogMSwKICAgICAgICBvcmRlcjogMSwKICAgICAgICBsaW1pdDogMQogICAgICB9OwogICAgICByZXR1cm4gIWtleXdvcmRzW2FsaWFzLnRvTG93ZXJDYXNlKCldOwogICAgfSwKICAgIC8vIOaLv+WIsHNxbCDovpPlhaXnmoTmiYDmnInooajlkozlr7nlupTnmoTliKvlkI0KICAgIGdldFRhYmxlc0FuZEFsaWFzKHNxbCkgewogICAgICBsZXQgQ09NQklORURfS0VZV09SRFMgPSBLRVlXT1JEUy5jb25jYXQoRlVOQ1RJT05TKTsKICAgICAgbGV0IG5hbWVzID0gW107CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgVEFCTEVTX1BBVFRFTlMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgcmVnID0gVEFCTEVTX1BBVFRFTlNbaV07CiAgICAgICAgZm9yICg7OykgewogICAgICAgICAgbGV0IGZvdW5kID0gcmVnLmV4ZWMoc3FsKTsKICAgICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgcmVnLmxhc3RJbmRleCA9IGZvdW5kLmluZGV4ICsgMTsKICAgICAgICAgIGxldCB0ID0gZm91bmRbMV07CgogICAgICAgICAgbGV0IGFsaWFzID0gIiI7CiAgICAgICAgICBpZiAoZm91bmRbMl0pIHsKICAgICAgICAgICAgYWxpYXMgPSBmb3VuZFsyXS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICBpZiAoIXRoaXMuaXNMZWdhbEFsaWFzKGFsaWFzKSkgewogICAgICAgICAgICAgIGFsaWFzID0gIiI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmIChDT01CSU5FRF9LRVlXT1JEUy5pbmRleE9mKHQudG9VcHBlckNhc2UoKSkgIT09IC0xKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIG5hbWVzLnB1c2goewogICAgICAgICAgICBuYW1lOiB0LAogICAgICAgICAgICBhbGlhczogYWxpYXMKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbmFtZXM7CiAgICB9LAogICAgc2hvd1N1Z2dlc3RNZW51KHR5cGUpIHsKICAgICAgbGV0IGF1dG9GbjsKICAgICAgaWYgKHRoaXMucnVuQ3VyKSB7CiAgICAgICAgbGV0IGN1ciA9IHRoaXMuY29kZW1pcnJvci5nZXRDdXJzb3IoKTsKICAgICAgICBpZiAoIV8uaXNFcXVhbCh0aGlzLnJ1bkN1ciwgY3VyKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHR5cGUgPT0gImxvY2FsIikgewogICAgICAgIGF1dG9GbiA9IHRoaXMuYXV0b0NvbXBsZXRlOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gInRhYmxlIikgewogICAgICAgIGF1dG9GbiA9IHRoaXMuYXV0b2NvbXBsZXRlVGFibGVzOwogICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gImNvbHVtbiIpIHsKICAgICAgICBhdXRvRm4gPSB0aGlzLmF1dG9jb21wbGV0ZUNvbHVtbnM7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuJHJlZnMuY29kZUVkaXRvciAmJiB0aGlzLiRyZWZzLmNvZGVFZGl0b3IuY29kZW1pcnJvcikgewogICAgICAgIENvZGVNaXJyb3Iuc2hvd0hpbnQodGhpcy4kcmVmcy5jb2RlRWRpdG9yLmNvZGVtaXJyb3IsIGF1dG9Gbik7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["sqlEditor.vue"],"names":[],"mappings":";;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"sqlEditor.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div class=\"sql-editor-wrapper\">\n    <codemirror v-model=\"sqlCode\" :options=\"editorOptions\" ref=\"codeEditor\"></codemirror>\n  </div>\n</template>\n\n<script>\nimport { codemirror, CodeMirror } from \"vue-codemirror\";\nimport sqlFormatter from \"sql-formatter\";\n_ = require('lodash')\nimport \"codemirror/lib/codemirror.css\";\n// 语言语法\nimport \"codemirror/mode/sql/sql\";\n// sql语言提示\nimport \"codemirror/addon/hint/sql-hint.js\";\n\n// active-line.js\nimport \"codemirror/addon/selection/active-line.js\";\n\n// styleSelectedText\nimport \"codemirror/addon/selection/mark-selection.js\";\nimport \"codemirror/addon/search/searchcursor.js\";\n\n// 自动提示\nimport \"codemirror/addon/hint/show-hint.js\";\nimport \"codemirror/addon/hint/show-hint.css\";\n\n// highlightSelectionMatches\nimport \"codemirror/addon/scroll/annotatescrollbar.js\";\nimport \"codemirror/addon/search/matchesonscrollbar.js\";\nimport \"codemirror/addon/search/searchcursor.js\";\nimport \"codemirror/addon/search/match-highlighter.js\";\n// keyMap\nimport \"codemirror/mode/clike/clike.js\";\nimport \"codemirror/keymap/sublime.js\";\n\n// foldGutter\nimport \"codemirror/addon/fold/foldgutter.css\";\nimport \"codemirror/addon/fold/brace-fold.js\";\nimport \"codemirror/addon/fold/comment-fold.js\";\nimport \"codemirror/addon/fold/foldcode.js\";\nimport \"codemirror/addon/fold/foldgutter.js\";\nimport \"codemirror/addon/fold/indent-fold.js\";\nimport \"codemirror/addon/fold/markdown-fold.js\";\nimport \"codemirror/addon/fold/xml-fold.js\";\n\n// theme css\nimport \"codemirror/theme/xq-dark.css\";\nimport \"codemirror/theme/xq-light.css\";\n\nimport { KEYWORDS, FUNCTIONS } from \"./editor-box\";\n\n\n// 匹配 （from || join）关键字\nconst TABLE_SUGGESET_POS_REG = /(^|\\s+)(from|join)\\s+(\\S*)$/i;\n\n// 匹配表名 别名\nconst TABLES_PATTENS = [\n  /\\sjoin\\s+([\\w._`]+)\\s*(?:as)?\\s*([\\w_`]+)?/gi,\n  /\\sfrom\\s+([\\w._`]+)\\s*(?:as)?\\s*([\\w_`]+)?/gi\n];\n\nexport default {\n  name: \"sqlEditor\",\n  components: {\n    codemirror\n  },\n  props: {},\n  data() {\n    return {\n      sqlCode: 'select\\n' +\n              '  distinct userid\\n' +\n              'from\\n' +\n              '  tutor.s_tutor_order_tp\\n' +\n              'where\\n' +\n              '  datediff(\\'2016-08-08\\', paiddt) >= 1\\n' +\n              '  and datediff(\\'2016-08-08\\', paiddt) <= ？ ？ --过去？天',\n      editorOptions: {\n        // codemirror options\n        tabSize: 4,\n        mode: \"text/x-mysql\",\n        theme: \"xq-light\",\n        fullScreen: false,\n        lineNumbers: true,\n        line: true,\n        // 代码折叠\n        foldGutter: true,\n        gutters: [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\"],\n        // 高级配置（需要引入对应的插件包）,codemirror advanced options(You need to manually introduce the corresponding codemirror function script code)\n        // sublime、emacs、vim三种键位模式，支持你的不同操作习惯\n        keyMap: \"sublime\",\n        // 按键映射，比如Ctrl键映射autocomplete，autocomplete是hint代码提示事件\n        extraKeys: {\n          F9: () => {\n            this.formatSqlFun();\n          },\n          \"Ctrl-space\": \"autocomplete\"\n        },\n        showHitObj: null, // 延迟显示联想列表\n        currentWord: \"\", // 关键字记录\n        updateTimer: null,\n        sqlSuggestList: [],\n        // 联想功能\n        // hint: （cm) => {\n        //   return this.Hint();\n        // }\n        // hint.js options\n        hintOptions: {\n          // 当匹配只有一项的时候是否自动补全\n          completeSingle: false\n        },\n        // 联想表名\n        sqlSuggestTableNameLists: [],\n        // 联想表\n        sqlSuggestTableLists: [],\n        // 联想列名\n        sqlSuggestColumns: [],\n        runCur: null\n        // 选中文本自动高亮，及高亮方式\n        // styleSelectedText: true,\n        // highlightSelectionMatches: { showToken: /\\w/, annotateScrollbar: true },\n        // more codemirror options...\n        // 如果有hint方面的配置，也应该出现在这里\n      }\n    };\n  },\n  computed: {\n    codemirror() {\n      return this.$refs.codeEditor.codemirror;\n    }\n  },\n  mounted() {\n    if (this.$refs.codeEditor) {\n      // 绑定键盘事件\n      this.$refs.codeEditor.codemirror.on(\"keyup\", this.handleEditorKeyUp);\n    }\n  },\n  destroyed() {},\n  methods: {\n    // 联想表名\n    autocompleteTables(editor) {\n      let cur = editor.getCursor();\n      let token = this.getToken(editor, cur);\n      let word = token.string.toLowerCase();\n      let list = [];\n\n      list = this.getSuggestListByRequsest(this.sqlSuggestTableNameLists, word);\n      this.hintSort(list, word);\n      return {\n        list: list,\n        from: CodeMirror.Pos(cur.line, token.start),\n        to: CodeMirror.Pos(cur.line, token.end)\n      };\n    },\n    // 联想表名|列名处理\n    getSuggestListByRequsest(list, word) {\n      let listArr = [];\n      let map = {};\n      for (let i = 0, len = list.length; i < len; i++) {\n        let item = list[i].toLowerCase();\n        if (item.indexOf(word.trim()) !== -1) {\n          // if (word === item) {\n          //     continue;\n          // }\n          if (!map[list[i]]) {\n            listArr.push(list[i]);\n            map[list[i]] = true;\n          }\n        }\n      }\n      return listArr;\n    },\n    autocompleteColumns(editor) {\n      let list = [];\n      let cur = editor.getCursor();\n      let token = this.getToken(editor, cur);\n      let word = token.string.toLowerCase();\n      //联想列名\n      let sqlSuggestColumns = this.getSuggestListByRequsest(\n        this.sqlSuggestColumns,\n        word\n      );\n      list = list.concat(sqlSuggestColumns);\n      this.hintSort(list, word);\n      list = [...new Set(list)];\n\n      return {\n        list: list,\n        from: CodeMirror.Pos(cur.line, token.start),\n        to: CodeMirror.Pos(cur.line, token.end)\n      };\n    },\n    // 本地关键字联想\n    autoComplete(editor) {\n      let COMBINED_KEYWORDS = KEYWORDS.concat(FUNCTIONS);\n      let cur = editor.getCursor();\n      let token = this.getToken(editor, cur);\n      let word = token.string.toLowerCase();\n      let list = [];\n      // let sql = editor.getValue();\n\n      //关键字,函数\n      if (word.indexOf(\".\") < 0) {\n        let a = this.getSuggestListByLocal(COMBINED_KEYWORDS, word);\n        list = list.concat(a);\n      }\n      //变量\n      if (word.indexOf(\".\") < 0) {\n        if (this.systemVars && this.systemVars.length) {\n          let arr = this.getSuggestListByLocal(this.systemVars, word);\n          list = list.concat(arr);\n        }\n      }\n      this.hintSort(list, word);\n      // if (list.length < 10) { // 加入已经输入的单词联想关键字\n      //     let words = sql.split(/[^\\w_\\u4e00-\\u9fa5]/);\n      //     let nwords = [];\n      //     for (let i = 0; i < words.length; i++) {\n      //         if ((!words[i]) || (word === words[i])) {\n      //             continue;\n      //         }\n      //         nwords.push(words[i]);\n      //     }\n      //     list = list.concat(this.getSuggestListByLocal(nwords, word));\n      // }\n      list = [...new Set(list)];\n\n      return {\n        list: list,\n        from: CodeMirror.Pos(cur.line, token.start),\n        to: CodeMirror.Pos(cur.line, token.end)\n      };\n    },\n    // 通过关键字 匹配获取suggest列表\n    getSuggestListByLocal(list, word) {\n      if (word.trim() === \"\") {\n        return [];\n      }\n\n      let map = {};\n      let listArr = [];\n      for (let i = 0, localL = list.length; i < localL; i++) {\n        let a = list[i].toLowerCase();\n        if (a.indexOf(word.trim()) !== -1) {\n          // if (isSelf && (word === a)) {\n          //     continue;\n          // }\n          if (!map[list[i]]) {\n            listArr.push(list[i]);\n            map[list[i]] = true;\n          }\n        }\n      }\n\n      return listArr;\n    },\n    hintSort(arr, key) {\n      for (let i = 0; i < arr.Length; i++) {\n        for (let j = i; j < arr.Length; j++) {\n          let a = arr[i].toLowerCase();\n          let b = arr[j].toLowerCase();\n          if (a.indexOf(key) > b.indexOf(key)) {\n            let temp = arr[i];\n            arr[i] = arr[j];\n            arr[j] = temp;\n          }\n        }\n      }\n    },\n    formatSqlFun() {\n      this.sqlCode = sqlFormatter.format(this.sqlCode, {});\n    },\n    // 键盘事件监听\n    handleEditorKeyUp(editor, e) {\n      this.timer && clearTimeout(this.timer);\n      this.timer = setTimeout(() => {\n        const value = editor.getValue().trim(); // 输入的所有sql\n        let cur = editor.getCursor();\n        let token = this.getToken(editor, cur);\n        let word = token.string.toLowerCase().trim(); // 关键字\n\n        if (\n          e.key === \"Enter\" ||\n          e.key === \"Tab\" ||\n          e.key === \"Escape\" ||\n          word === \"\"\n        ) {\n          this.currentWord = \"\";\n          return true;\n        }\n        if (\n          this.currentWord === word &&\n          (e.key === \"ArrowUp\" || e.key === \"ArrowDown\")\n        ) {\n          return true;\n        }\n        this.currentWord = word;\n        // 复位\n        this.sqlSuggestColumns = [];\n        this.runCur = cur;\n        this.getSuggestData(editor, value, word);\n      }, 100);\n    },\n    // 获取光标的位置\n    getToken(e, cur) {\n      let t = e.getTokenAt(cur);\n\n      if (\n        t.string &&\n        (t.string.indexOf(\".\") >= 0 || t.string.indexOf(\"$\") >= 0)\n      ) {\n        if (cur.ch > 0) {\n          let before = e.getTokenAt({\n            line: cur.line,\n            ch: t.start\n          });\n          t.string = (before.string + t.string).trim();\n          t.start = before.start;\n        }\n      }\n      return t;\n    },\n    // execSql() {\n    //   let sql =\n    //     (this.codemirror && this.codemirror.getSelection()) || this.sqlCode;\n    //   let postData = { db: this.db, name: this.sqlName, sql };\n    //   console.log(execSql);\n    //   execSql(postData).then(data => {\n    //     console.log(data);\n    //   });\n    //   console.log(sql);\n    // },\n    getSuggestData(editor, value, word) {\n      let cur = editor.getCursor();\n      // 记录当前查询关键词\n      if (word.trim() === \"\") {\n        return;\n      }\n      let tablesAlias = this.getTablesAndAlias(value);\n      let leftValue = editor.getRange({ line: 0, ch: 0 }, cur);\n      // if (TABLE_SUGGESET_POS_REG.test(leftValue) && this.dsName) {\n      //   // from join 后请求表名\n      //   this.getHintTables({ dsName: this.dsName, q: word });\n      // } else if (tablesAlias.length && this.dsName) {\n      //   // 是否有表 表是否有别名\n      //   this.getHintColumns(tablesAlias, word);\n      // } else {\n      //   this.showSuggestMenu(\"local\"); // 本地联想\n      // }\n      if (TABLE_SUGGESET_POS_REG.test(leftValue)) {\n        // from join 后请求表名\n        this.getHintTables();\n      } else if (tablesAlias.length) {\n        // 是否有表 表是否有别名\n        this.getHintColumns(tablesAlias, word);\n      } else {\n        this.showSuggestMenu('local'); // 本地联想\n      }\n    },\n    getHintTables() {\n      this.sqlSuggestTableNameLists = ['aaa','bbb','ccc', 'def', 'table1','table2','table3','table4', 'ghy'];\n      this.showSuggestMenu(\"table\");\n    },\n    getHintColumns(tablesAlias, word) {\n      let tables = [];\n      let table;\n      let body = {};\n      let leftWord;\n      let idx = word.indexOf(\".\");\n      if (idx !== -1) {\n        leftWord = word.substr(0, idx);\n\n        tablesAlias.forEach((item, i) => {\n          if (item.alias === leftWord) {\n            table = item.name;\n          }\n        });\n\n        if (table) {\n          body.tables = [table];\n          this.getColumnList();\n        }\n      } else {\n        tablesAlias.forEach((item, i) => {\n          if (item.name !== \"\") {\n            tables.push(item.name);\n          }\n        });\n\n        tables = [...new Set(tables)];\n        body.tables = tables;\n\n        if (tables.length) {\n          this.getColumnList({ body });\n        }\n      }\n    },\n    getColumnList() {\n      this.sqlSuggestColumns = ['user', 'age', 'name', 'id', 'abc', 'efg', 'hij', 'klm', 'nuv', 'wh'];\n      this.showSuggestMenu(\"column\");\n    },\n    // 别名是否合法\n    isLegalAlias(alias) {\n      let keywords = {\n        where: 1,\n        on: 1,\n        using: 1,\n        join: 1,\n        group: 1,\n        order: 1,\n        limit: 1\n      };\n      return !keywords[alias.toLowerCase()];\n    },\n    // 拿到sql 输入的所有表和对应的别名\n    getTablesAndAlias(sql) {\n      let COMBINED_KEYWORDS = KEYWORDS.concat(FUNCTIONS);\n      let names = [];\n      for (let i = 0; i < TABLES_PATTENS.length; i++) {\n        let reg = TABLES_PATTENS[i];\n        for (;;) {\n          let found = reg.exec(sql);\n          if (!found) {\n            break;\n          }\n\n          reg.lastIndex = found.index + 1;\n          let t = found[1];\n\n          let alias = \"\";\n          if (found[2]) {\n            alias = found[2].toLowerCase();\n            if (!this.isLegalAlias(alias)) {\n              alias = \"\";\n            }\n          }\n          if (COMBINED_KEYWORDS.indexOf(t.toUpperCase()) !== -1) {\n            continue;\n          }\n\n          names.push({\n            name: t,\n            alias: alias\n          });\n        }\n      }\n      return names;\n    },\n    showSuggestMenu(type) {\n      let autoFn;\n      if (this.runCur) {\n        let cur = this.codemirror.getCursor();\n        if (!_.isEqual(this.runCur, cur)) {\n          return;\n        }\n      }\n\n      if (type == \"local\") {\n        autoFn = this.autoComplete;\n      } else if (type == \"table\") {\n        autoFn = this.autocompleteTables;\n      } else if (type == \"column\") {\n        autoFn = this.autocompleteColumns;\n      }\n      if (this.$refs.codeEditor && this.$refs.codeEditor.codemirror) {\n        CodeMirror.showHint(this.$refs.codeEditor.codemirror, autoFn);\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.sql-editor-wrapper {\n  height: 800px;\n}\n.vue-codemirror {\n  height: 100%;\n  overflow: hidden;\n  /deep/ .CodeMirror {\n    height: 100%;\n    overflow: auto;\n    .CodeMirror-lines {\n      padding-top: 6px;\n    }\n  }\n}\n</style>"]}]}