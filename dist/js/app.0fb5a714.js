(function(e){function t(t){for(var s,i,l=t[0],a=t[1],u=t[2],c=0,g=[];c<l.length;c++)i=l[c],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&g.push(o[i][0]),o[i]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s]);d&&d(t);while(g.length)g.shift()();return n.push.apply(n,u||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],s=!0,l=1;l<r.length;l++){var a=r[l];0!==o[a]&&(s=!1)}s&&(n.splice(t--,1),e=i(i.s=r[0]))}return e}var s={},o={app:0},n=[];function i(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=s,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(r,s,function(t){return e[t]}.bind(null,s));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],a=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var d=a;n.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},2395:function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);var s=r("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("sql-editor")],1)},n=[],i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"sql-editor-wrapper"},[r("codemirror",{ref:"codeEditor",attrs:{options:e.editorOptions},model:{value:e.sqlCode,callback:function(t){e.sqlCode=t},expression:"sqlCode"}})],1)},l=[],a=r("8f94"),u=r("db05"),d=r.n(u);r("a7be"),r("ffda"),r("991c"),r("31c5"),r("9948"),r("b933"),r("9b74"),r("f6b6"),r("9c7b"),r("715d"),r("23de"),r("4ba6"),r("9a48"),r("697e"),r("aedd"),r("164b"),r("4895"),r("cbc8"),r("8d70"),r("9f09"),r("a2c1"),r("bd58"),r("8d7e");const c=["SELECT","DEFAULT","HAVING","LIMIT","COUNT","SUM","AVG","MIN","MAX","DISTINCT","DATEDIFF","BETWEEN","AND","WHERE","FROM","JOIN","USING","CREATE","TABLE","FROM_UNIXTIME","UNIX_TIMESTAMP","NOT","NULL","LIKE","CASE","WHEN","THEN","ELSE","END","ON","UNION","ALL","RIGHT","CAST","AS","OR","DATE","IN","INT","UNSIGNED","OUTER","COALESCE","MINUTES","DAY","INTERVAL","IS","MONTH","HOUR"],g=["CONCAT","SUBSTR","SUBSTRING_INDEX","YEAR_MONTH","EXTRACT","FLOOR","ROUND","SECONDS","MINITES","IF","IFNULL","GROUP BY","ORDER BY","LOWER","UPPER"];_=r("2ef0");const h=/(^|\s+)(from|join)\s+(\S*)$/i,f=[/\sjoin\s+([\w._`]+)\s*(?:as)?\s*([\w_`]+)?/gi,/\sfrom\s+([\w._`]+)\s*(?:as)?\s*([\w_`]+)?/gi];var m={name:"sqlEditor",components:{codemirror:a["codemirror"]},props:{},data(){return{sqlCode:"select\n  distinct userid\nfrom\n  tutor.s_tutor_order_tp\nwhere\n  datediff('2016-08-08', paiddt) >= 1\n  and datediff('2016-08-08', paiddt) <= ？ ？ --过去？天",editorOptions:{tabSize:4,mode:"text/x-mysql",theme:"xq-light",fullScreen:!1,lineNumbers:!0,line:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],keyMap:"sublime",extraKeys:{F9:()=>{this.formatSqlFun()},"Ctrl-space":"autocomplete"},showHitObj:null,currentWord:"",updateTimer:null,sqlSuggestList:[],hintOptions:{completeSingle:!1},sqlSuggestTableNameLists:[],sqlSuggestTableLists:[],sqlSuggestColumns:[],runCur:null}}},computed:{codemirror(){return this.$refs.codeEditor.codemirror}},mounted(){this.$refs.codeEditor&&this.$refs.codeEditor.codemirror.on("keyup",this.handleEditorKeyUp)},destroyed(){},methods:{autocompleteTables(e){let t=e.getCursor(),r=this.getToken(e,t),s=r.string.toLowerCase(),o=[];return o=this.getSuggestListByRequsest(this.sqlSuggestTableNameLists,s),this.hintSort(o,s),{list:o,from:a["CodeMirror"].Pos(t.line,r.start),to:a["CodeMirror"].Pos(t.line,r.end)}},getSuggestListByRequsest(e,t){let r=[],s={};for(let o=0,n=e.length;o<n;o++){let n=e[o].toLowerCase();-1!==n.indexOf(t.trim())&&(s[e[o]]||(r.push(e[o]),s[e[o]]=!0))}return r},autocompleteColumns(e){let t=[],r=e.getCursor(),s=this.getToken(e,r),o=s.string.toLowerCase(),n=this.getSuggestListByRequsest(this.sqlSuggestColumns,o);return t=t.concat(n),this.hintSort(t,o),t=[...new Set(t)],{list:t,from:a["CodeMirror"].Pos(r.line,s.start),to:a["CodeMirror"].Pos(r.line,s.end)}},autoComplete(e){let t=c.concat(g),r=e.getCursor(),s=this.getToken(e,r),o=s.string.toLowerCase(),n=[];if(o.indexOf(".")<0){let e=this.getSuggestListByLocal(t,o);n=n.concat(e)}if(o.indexOf(".")<0&&this.systemVars&&this.systemVars.length){let e=this.getSuggestListByLocal(this.systemVars,o);n=n.concat(e)}return this.hintSort(n,o),n=[...new Set(n)],{list:n,from:a["CodeMirror"].Pos(r.line,s.start),to:a["CodeMirror"].Pos(r.line,s.end)}},getSuggestListByLocal(e,t){if(""===t.trim())return[];let r={},s=[];for(let o=0,n=e.length;o<n;o++){let n=e[o].toLowerCase();-1!==n.indexOf(t.trim())&&(r[e[o]]||(s.push(e[o]),r[e[o]]=!0))}return s},hintSort(e,t){for(let r=0;r<e.Length;r++)for(let s=r;s<e.Length;s++){let o=e[r].toLowerCase(),n=e[s].toLowerCase();if(o.indexOf(t)>n.indexOf(t)){let t=e[r];e[r]=e[s],e[s]=t}}},formatSqlFun(){this.sqlCode=d.a.format(this.sqlCode,{})},handleEditorKeyUp(e,t){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{const r=e.getValue().trim();let s=e.getCursor(),o=this.getToken(e,s),n=o.string.toLowerCase().trim();return"Enter"===t.key||"Tab"===t.key||"Escape"===t.key||""===n?(this.currentWord="",!0):this.currentWord===n&&("ArrowUp"===t.key||"ArrowDown"===t.key)||(this.currentWord=n,this.sqlSuggestColumns=[],this.runCur=s,void this.getSuggestData(e,r,n))},100)},getToken(e,t){let r=e.getTokenAt(t);if(r.string&&(r.string.indexOf(".")>=0||r.string.indexOf("$")>=0)&&t.ch>0){let s=e.getTokenAt({line:t.line,ch:r.start});r.string=(s.string+r.string).trim(),r.start=s.start}return r},getSuggestData(e,t,r){let s=e.getCursor();if(""===r.trim())return;let o=this.getTablesAndAlias(t),n=e.getRange({line:0,ch:0},s);h.test(n)?this.getHintTables():o.length?this.getHintColumns(o,r):this.showSuggestMenu("local")},getHintTables(){this.sqlSuggestTableNameLists=["aaa","bbb","ccc","def","table1","table2","table3","table4","ghy"],this.showSuggestMenu("table")},getHintColumns(e,t){let r,s,o=[],n={},i=t.indexOf(".");-1!==i?(s=t.substr(0,i),e.forEach((e,t)=>{e.alias===s&&(r=e.name)}),r&&(n.tables=[r],this.getColumnList())):(e.forEach((e,t)=>{""!==e.name&&o.push(e.name)}),o=[...new Set(o)],n.tables=o,o.length&&this.getColumnList({body:n}))},getColumnList(){this.sqlSuggestColumns=["user","age","name","id","abc","efg","hij","klm","nuv","wh"],this.showSuggestMenu("column")},isLegalAlias(e){let t={where:1,on:1,using:1,join:1,group:1,order:1,limit:1};return!t[e.toLowerCase()]},getTablesAndAlias(e){let t=c.concat(g),r=[];for(let s=0;s<f.length;s++){let o=f[s];for(;;){let s=o.exec(e);if(!s)break;o.lastIndex=s.index+1;let n=s[1],i="";s[2]&&(i=s[2].toLowerCase(),this.isLegalAlias(i)||(i="")),-1===t.indexOf(n.toUpperCase())&&r.push({name:n,alias:i})}}return r},showSuggestMenu(e){let t;if(this.runCur){let e=this.codemirror.getCursor();if(!_.isEqual(this.runCur,e))return}"local"==e?t=this.autoComplete:"table"==e?t=this.autocompleteTables:"column"==e&&(t=this.autocompleteColumns),this.$refs.codeEditor&&this.$refs.codeEditor.codemirror&&a["CodeMirror"].showHint(this.$refs.codeEditor.codemirror,t)}}},p=m,b=(r("e57d"),r("2877")),C=Object(b["a"])(p,i,l,!1,null,"95f3748e",null),S=C.exports,E={components:{SqlEditor:S}},T=E,O=(r("7c55"),Object(b["a"])(T,o,n,!1,null,null,null)),L=O.exports;new s["a"]({render:e=>e(L)}).$mount("#app")},"7c55":function(e,t,r){"use strict";var s=r("2395"),o=r.n(s);o.a},e2ea:function(e,t,r){},e57d:function(e,t,r){"use strict";var s=r("e2ea"),o=r.n(s);o.a}});
//# sourceMappingURL=app.0fb5a714.js.map